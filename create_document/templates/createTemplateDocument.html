{% extends 'layout1.html' %}
{% load static %}

{% block css %}

    .meta_filled{
        background-color: #d2ffcc;
        padding: 2px 5px;
    }
    .btn-sm{
        padding:0.25rem 1.5rem;
        line-height:1.5;
        border-radius:1.2rem;
        font-size: 13px;
    }
    .select2-container {
        min-width: 330px;
    }
    .select2-results__options{
        font-size:14px !important;
    }
    .select2-results__placeholders{
        font-size:11px !important;
    }

    textarea,input{
    border-width:1px !important;
    }
    textarea:hover,input:hover,select:hover{
    box-shadow: 0 0.5em 0.5em -0.4em var(--hover) !important;
    transform: translateY(-0.05em) !important;
    }


        /* hide number up down arrow Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    /* hide number up down arrow Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }


    .document-box {
    max-width: 820px;
    margin: 40px auto;
    padding: 60px;
    background: white;
    font-family: "Times New Roman", serif;
    font-size: 15px;
    line-height: 1.6;
    color: #000;
    box-shadow: 0 0 0 1px #ddd;
}

/* DOCX paragraph feel */
.document-box p {
    margin-bottom: 12px;
}

/* Shared input look */
.doc-input {
    font-family: inherit;
    font-size: inherit;
    background: rgba(173, 216, 230, 0.25); /* faint blue */
    border: none;
    border-bottom: 1px solid #7aa7d9;
    padding: 2px 4px;
    margin: 0 3px;
    outline: none;
    min-width: 120px;
    display: inline-block;
    transition: all 0.2s ease;
}

/* Focus like Word */
.doc-input:focus {
    background: rgba(173, 216, 230, 0.45);
    border-bottom: 2px solid #2b6cb0;
}

/* Textarea inline */
.textarea-input {
    resize: none;
    overflow: hidden;
    vertical-align: baseline;
}

/* Date input */
.date-input {
    min-width: 140px;
}

/* Select input */
.select-input {
    background-color: rgba(173, 216, 230, 0.25);
}

/* File input */
.file-input {
    font-size: 13px;
}
.doc-header, .doc-footer {
    text-align: center;
    font-size: 12px;
    margin: 20px 0;
}

.page-break {
    page-break-before: always;
    break-before: page;
}

.doc-table {
    width: 100%;
    border-collapse: collapse;
}

.doc-table td {
    border: 1px solid #333;
    padding: 6px;
}

.signature-table td {
    border: none;
    padding-top: 20px;
}
.textarea-input {
    resize: none;
    overflow: hidden;
    min-height: 24px;
    line-height: 1.4;
    width: 100%;
    box-sizing: border-box;
}
/* ---------- SIGNATURE MODAL OVERLAY ---------- */
.signature-modal {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.55);
    backdrop-filter: blur(4px);
    z-index: 1055;
    display: none;
    align-items: center;
    justify-content: center;
}

/* ---------- SIGNATURE BOX ---------- */
.signature-box {
    background: #ffffff;
    width: 520px;
    max-width: 95%;
    border-radius: 16px;
    padding: 24px 26px;
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.25);
    animation: scaleIn 0.25s ease;
}

/* ---------- TITLE ---------- */
.signature-box h4 {
    font-weight: 600;
    margin-bottom: 18px;
    text-align: center;
    color: #2c3e50;
}

/* ---------- SIGNATURE OPTIONS ---------- */
.sig-options {
    display: flex;
    justify-content: center;
    gap: 18px;
    margin-bottom: 16px;
}

.sig-options label {
    cursor: pointer;
    font-weight: 500;
    color: #555;
}

.sig-options input[type="radio"] {
    margin-right: 6px;
}

/* ---------- CANVAS ---------- */
#sigCanvas {
    border: 2px dashed #d1d5db;
    border-radius: 12px;
    background: #fafafa;
    width: 100%;
    margin-bottom: 12px;
}

/* ---------- TYPE INPUT ---------- */
.sig-type-input {
    width: 100%;
    border-radius: 10px;
    border: 1px solid #ced4da;
    padding: 10px 14px;
    font-size: 16px;
    margin-bottom: 12px;
}

/* ---------- IMAGE INPUT ---------- */
#sigImage {
    width: 100%;
    margin-bottom: 12px;
}

/* ---------- ACTION BUTTONS ---------- */
.sig-actions {
    margin-top: 18px;
    text-align: center;
}

.sig-actions .btn {
    width: 100%;
    border-radius: 10px;
    font-weight: 500;
    padding: 8px 0;
}

/* ---------- PREVIEW IMAGE ---------- */
.sig-preview-img {
    max-height: 80px;
    margin-top: 6px;
    border-radius: 6px;
    border: 1px solid #ddd;
}

/* ---------- TYPED SIGNATURE ---------- */
.typed-signature {
    font-family: 'Pacifico', cursive;
    font-size: 26px;
    color: #111;
}

/* ---------- ANIMATION ---------- */
@keyframes scaleIn {
    from {
        transform: scale(0.95);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}



{% endblock %}
{% block content %}
<div style="margin-left:125px;width:80.5vw;" >
    <div class="container-fluid py-3" style="margin-left:0px;background:#fafafa;height:70px;">
        <h4>{{ template.temp_title }}</h4>
        <p><b>Note:</b> Document Viewer is approximate</p>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="document-box">
                {{ ui_text|safe }}
            </div>
            <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#fileNameModal"
                    style="margin-left: 470px;margin-bottom:100px;">
                <i class="fas fa-plus-circle pr-2"></i>Create New
            </button>
            <!-- Modal -->
            <div class="modal fade" id="fileNameModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">File Name(saved as .docx)</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <label for="file_name">Please enter name of the file for saving</label>
                    <input type="text" name="file_name" id="file_name" value="{{ document_name }}" class="form-control">
                      <span id="fileNameError" style="color: red"></span>
                      <br>
                    <div class="form-group">
                        {% if user_groups %}
                            <label class="pb-2">Document Groups</label>
                            <div class="scroll form-group">
                                <select multiple class="mul-select" name="group_select">
                                    {% for group in user_groups %}
                                    <option value="{{ group.name }}" class="form-control">{{ group.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        {% endif %}
                    </div>

                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Signature Modal -->
            <div id="signatureModal" class="signature-modal">
              <div class="signature-box">

                <h4>‚úç Add Signature</h4>

                <div class="sig-options">
                  <label><input type="radio" name="sig_type" value="draw" checked> Draw</label>
                  <label><input type="radio" name="sig_type" value="image"> Image</label>
                  <label><input type="radio" name="sig_type" value="type"> Type</label>
                </div>

                <!-- Draw -->
                <canvas id="sigCanvas" width="400" height="150"></canvas>

                <!-- Image -->
                <input type="file" id="sigImage" accept="image/*" style="display:none">

                <!-- Type -->
                <input type="text"
                       id="sigTypeText"
                       placeholder="Type your name"
                       style="display:none"
                       class="sig-type-input">

                <div class="row sig-actions g-2">
                  <div class="col">
                    <button class="btn btn-outline-secondary btn-sm" type="button" id="sigClear">
                      Clear
                    </button>
                  </div>
                  <div class="col">
                    <button class="btn btn-primary btn-sm" type="button" id="sigSave">
                      Save
                    </button>
                  </div>
                  <div class="col">
                    <button class="btn btn-outline-warning btn-sm" type="button" id="sigCancel">
                      Cancel
                    </button>
                  </div>
                </div>

              </div>
            </div>


        </form>
    </div>
</div>



{% endblock %}

{% block extracode %}
<script src="{% static 'custom/js/create_document_template.js' %}?version=7" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.8/js/select2.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
{% endblock %}


